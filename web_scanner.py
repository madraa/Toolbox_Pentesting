import subprocess  # Importation du module subprocess pour exécuter des commandes système

def scan_web_application():
    # Fonction pour scanner une application web avec différentes options
    print("\nScanner des applications web\n" + "-"*30)  # Affichage du titre de la section
    url = input("Entrez l'URL de l'application web à scanner: ")  # Demande à l'utilisateur de saisir l'URL à scanner
    print("Options de scan:")
    print("1. Scan rapide")
    print("2. Scan complet")
    print("3. Détection de vulnérabilités SQL")
    choix_scan = input("Choisissez le type de scan [1-3]: ")  # Demande à l'utilisateur de choisir le type de scan

    command = ["sqlmap", "-u", url, "--batch"]  # Commande de base pour sqlmap avec l'URL et l'option --batch pour l'exécution automatique

    if choix_scan == "1":
        command.extend(["--level", "1"])  # Ajout d'options pour un scan rapide
    elif choix_scan == "2":
        command.extend(["--level", "5", "--risk", "3"])  # Ajout d'options pour un scan complet avec un niveau de risque élevé
    elif choix_scan == "3":
        command.extend(["--dbms", "mysql", "--dump"])  # Ajout d'options pour détecter les vulnérabilités SQL et dumper la base de données MySQL
    else:
        print("Choix non valide. Exécution d'un scan rapide par défaut.")  # Message d'erreur pour un choix non valide
        command.extend(["--level", "1"])  # Par défaut, effectuer un scan rapide

    try:
        subprocess.run(command, check=True)  # Exécution de la commande avec subprocess.run et vérification des erreurs
        print("Scan terminé avec succès.")  # Message de succès si le scan est terminé sans erreur
    except subprocess.CalledProcessError as e:
        print(f"Erreur lors du scan de l'application web: {e}")  # Message d'erreur en cas de problème pendant le scan

# Exemple d'utilisation dans ce fichier, peut être commenté ou supprimé dans la version finale
if __name__ == "__main__":
    scan_web_application()  # Appel de la fonction scan_web_application si le script est exécuté directement
