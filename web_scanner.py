import subprocess

def scan_web_application():
    print("\nScanner des applications web\n" + "-"*30)
    url = input("Entrez l'URL de l'application web à scanner: ")
    print("Options de scan:")
    print("1. Scan rapide")
    print("2. Scan complet")
    print("3. Détection de vulnérabilités SQL")
    choix_scan = input("Choisissez le type de scan [1-3]: ")

    command = ["sqlmap", "-u", url, "--batch"]

    if choix_scan == "1":
        command.extend(["--level", "1"])
    elif choix_scan == "2":
        command.extend(["--level", "5", "--risk", "3"])
    elif choix_scan == "3":
        command.extend(["--dbms", "mysql", "--dump"])
    else:
        print("Choix non valide. Exécution d'un scan rapide par défaut.")
        command.extend(["--level", "1"])

    try:
        subprocess.run(command, check=True)
        print("Scan terminé avec succès.")
    except subprocess.CalledProcessError as e:
        print(f"Erreur lors du scan de l'application web: {e}")

# Exemple d'utilisation dans ce fichier, peut être commenté ou supprimé dans la version finale
if __name__ == "__main__":
    scan_web_application()