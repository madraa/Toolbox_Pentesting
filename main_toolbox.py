import sys
import network_discovery
import vulnerability_analysis
import web_scanner
import auth_tests
import brute_force_login
import vulnerability_exploitation
from pymetasploit3.msfrpc import MsfRpcClient
#import reporting
import password_analysis

# Affichage de l'en-tête avec le nom en style ASCII personnalisé
def display_header():
    header = r"""
 ____                           _____                     _ _ _   
|  _ \ __ _ _   _  __ _ _ __   |_   _|_ _ _ __ ___   __ _| (_) |_ 
| |_) / _` | | | |/ _` | '_ \    | |/ _` | '_ ` _ \ / _` | | | __|
|  _ < (_| | |_| | (_| | | | |   | | (_| | | | | | | (_| | | | |_ 
|_| \_\__,_|\__, |\__,_|_| |_|   |_|\__,_|_| |_| |_|\__, |_|_|\__|
            |___/                                   |___/                               
    """
    print(header)
    print("Toolbox de Tests d'Intrusion - Rayan Tamglit\n" + "-" * 80)


# Menu principal pour la sélection des modules de la toolbox
def main_menu():
    display_header()
    print("Menu Principal:\n")
    print("1. Découverte de réseau")
    print("2. Analyse de vulnérabilités")
    print("3. Analyse de sécurité de mot de passe")
    print("4. Brute Force sur formulaire de connexion")
    print("5. Tests d'authentification")
    print("6. Exploitation de vulnérabilités")
  #  print("7. Reporting et visualisation")
    print("8. Quitter\n")
    
    choice = input("Veuillez choisir une option [1-8]: ")
    return choice


# Navigation vers les modules en fonction du choix de l'utilisateur
def navigate_to_module(choice):
    if choice == '1':
        network_discovery.network_discovery_menu()
    elif choice == '2':
        vulnerability_analysis.vulnerability_analysis_menu()
    elif choice == '3':
        password_analysis.interactive_password_check()
    elif choice == '4':
        brute_force_login.get_user_input()
    elif choice == '5':
        auth_tests.authentication_menu()
    elif choice == '6':
        vulnerability_exploitation.exploitation_menu()
  #  elif choice == '7':
  #      print("Modules en cour de développement...")
  #      print("Rapport généré.")
    elif choice == '8':
        print("Fermeture de la toolbox...  À bientôt !")
        sys.exit()
    else:
        print("Option non valide, veuillez réessayer.")


# Boucle principale du programme
def main():
    while True:
        choice = main_menu()
        navigate_to_module(choice)


if __name__ == "__main__":
    main()
